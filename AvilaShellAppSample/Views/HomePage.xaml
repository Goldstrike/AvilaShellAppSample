<?xml version="1.0" encoding="UTF-8"?>
<ContentPage xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="AvilaShellAppSample.Views.HomePage"
             xmlns:ctrl="clr-namespace:AvilaShellAppSample.Controls"
             xmlns:local="clr-namespace:AvilaShellAppSample;assembly=AvilaShellAppSample"
             xmlns:conv="clr-namespace:AvilaShellAppSample.Converters"
             xmlns:vm="clr-namespace:AvilaShellAppSample.ViewModels"
             Title="{Binding Title}">
    <ContentPage.BindingContext>
        <vm:HomeViewModel />
    </ContentPage.BindingContext>
      <ContentPage.Resources>
    <ResourceDictionary>
       <conv:ByteArrayToImageSourceConverter  x:Key="ByteArrayToImageSourceConverter" />
   </ResourceDictionary>
 </ContentPage.Resources>
    <ContentPage.Content>
        <ScrollView>
            <StackLayout Spacing="16"
                         Margin="0"
                         Padding="0">

                <!-- Image + menu -->
                <ctrl:ShadowFrame Padding="0" Margin="0">
                    <!--
                    <Grid Padding="0" Margin="0">
                     <Image x:Name="avilaImage"
                       Source="{Binding AvilaIndoorImageSource}"
                       Aspect="AspectFill"
                       HeightRequest="200"
                       HorizontalOptions="FillAndExpand"
                       VerticalOptions="Start"/>
                     <Label Text="Welcome to Avila"
                            VerticalOptions="End"
                            HorizontalOptions="Center"
                            BackgroundColor="#66000000" />
                    </Grid>
                    -->

                    <AbsoluteLayout x:Name="ViewLayout">
                        <Image x:Name="avilaImage"
                               Source="{Binding AvilaIndoorImageSource}"
                               Aspect="AspectFill"
                               HeightRequest="200"
                               HorizontalOptions="FillAndExpand" VerticalOptions="Start"
                               AbsoluteLayout.LayoutBounds="1,1,1,1" AbsoluteLayout.LayoutFlags="All" />
                        <AbsoluteLayout x:Name="ViewControls" AbsoluteLayout.LayoutBounds="1,1,1,.20" AbsoluteLayout.LayoutFlags="All"
                                        BackgroundColor="#66000000" Margin="0">
                            <StackLayout Orientation="Vertical" Margin="10" BackgroundColor="Transparent" AbsoluteLayout.LayoutFlags="All" AbsoluteLayout.LayoutBounds="1,1,1,1">
                                <Grid Margin="1">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <Label Text="Bienvenue chez Avila" TextColor="White" HorizontalOptions="CenterAndExpand" VerticalOptions="End" Grid.Column="0"   />
                                </Grid>
                            </StackLayout>
                        </AbsoluteLayout>
                    </AbsoluteLayout>
                </ctrl:ShadowFrame>

                <!-- Phone -->
                <ctrl:ShadowFrame>
                    <StackLayout>
                        <Label Text="Téléphone"
                               TextColor="{StaticResource HomeHeader}"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="40" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <Image HorizontalOptions="Center" VerticalOptions="Center">
                                <Image.Source>
                                    <FontImageSource Glyph="{StaticResource FasIconPhone}"
                                                     Color="{StaticResource HomeDetails}"
                                                     FontFamily="FontAwesomeSolid"
                                                     Size="30" />
                                </Image.Source>
                            </Image>
                            <Label Grid.Column="1"
                                   Text="{Binding AvilaPhoneNumber}"
                                   TextColor="{StaticResource HomeDetails}"
                                   VerticalTextAlignment="Center"/>
                        </Grid>
                    </StackLayout>
                    <ctrl:ShadowFrame.GestureRecognizers>
                        <TapGestureRecognizer Command="{Binding CallCommand}"/>
                    </ctrl:ShadowFrame.GestureRecognizers>   
                </ctrl:ShadowFrame>

                <!-- Address -->
                <ctrl:ShadowFrame>
                    <StackLayout>
                        <Label Text="Adresse"
                               TextColor="{StaticResource HomeHeader}"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="40" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <Image HorizontalOptions="Center" VerticalOptions="Center">
                                <Image.Source>
                                    <FontImageSource Glyph="{StaticResource FasIconMap}"
                                                     Color="{StaticResource HomeDetails}"
                                                     FontFamily="FontAwesomeSolid"
                                                     Size="30" />
                                </Image.Source>
                            </Image>
                            <Label Grid.Column="1"
                                   TextColor="{StaticResource HomeDetails}"
                                   VerticalTextAlignment="Center" HorizontalTextAlignment="Start">
                                <Label.FormattedText>
                                    <FormattedString>
                                        <Span Text="{Binding AvilaAddress.StreetNumber}" />
                                        <Span Text=" " />
                                        <Span Text="{Binding AvilaAddress.StreetName}" />
                                        <Span Text="&#10;" />
                                        <Span Text="{Binding AvilaAddress.ZipCode}" />
                                        <Span Text=" " />
                                        <Span Text="{Binding AvilaAddress.City}" />
                                    </FormattedString>
                                </Label.FormattedText>
                            </Label>
                        </Grid>
                    </StackLayout>
                    <ctrl:ShadowFrame.GestureRecognizers>
                        <TapGestureRecognizer Command="{Binding OpenMapCommand}"/>
                    </ctrl:ShadowFrame.GestureRecognizers>   
                </ctrl:ShadowFrame>

                <!-- Schedule -->
                <ctrl:ShadowFrame>
                    <StackLayout>
                        <Label Text="Horaires"
                               TextColor="{StaticResource HomeHeader}"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="40" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <Image HorizontalOptions="Center" VerticalOptions="Center">
                                <Image.Source>
                                    <FontImageSource Glyph="{StaticResource FasIconClock}"
                                                     Color="{StaticResource HomeDetails}"
                                                     FontFamily="FontAwesomeSolid"
                                                     Size="30" />
                                </Image.Source>
                            </Image>
                            <Label Grid.Column="1"
                                   TextColor="{StaticResource HomeDetails}"
                                   VerticalTextAlignment="Center" HorizontalTextAlignment="Start">
                                <Label.Text>
                                    Lundi : 9h - 20h&#10;Mardi : 9h - 20h&#10;Mercredi : 9h - 20h&#10;Jeudi : 9h - 20h&#10;Vendredi : 9h - 20h&#10;Samedi : 9h - 17h&#10;Dimanche : fermé
                                </Label.Text>
                            </Label>
                        </Grid>
                    </StackLayout>
                </ctrl:ShadowFrame>

                <!-- Mail -->
                <ctrl:ShadowFrame>
                    <StackLayout>
                        <Label Text="Mail"
                               TextColor="{StaticResource HomeHeader}"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="40" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <Image HorizontalOptions="Center" VerticalOptions="Center">
                                <Image.Source>
                                    <FontImageSource Glyph="{StaticResource FasIconMail}"
                                                     Color="{StaticResource HomeDetails}"
                                                     FontFamily="FontAwesomeSolid"
                                                     Size="30" />
                                </Image.Source>
                            </Image>
                            <Label Grid.Column="1"
                                   Text="{Binding AvilaEmail}"
                                   TextColor="{StaticResource HomeDetails}"
                                   VerticalTextAlignment="Center" HorizontalTextAlignment="Start">
                            </Label>
                        </Grid>
                    </StackLayout>
                    <ctrl:ShadowFrame.GestureRecognizers>
                        <TapGestureRecognizer Command="{Binding SendEmailCommand}"/>
                    </ctrl:ShadowFrame.GestureRecognizers> 
                </ctrl:ShadowFrame>

            </StackLayout>
        </ScrollView>
    </ContentPage.Content>
</ContentPage>
